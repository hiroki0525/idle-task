<img alt="idle-task" src="data:image/png;base64,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">

# idle-task

[![npm version](https://badge.fury.io/js/idle-task.svg)](https://badge.fury.io/js/idle-task)
[![Test](https://github.com/hiroki0525/idle-task/actions/workflows/test.yml/badge.svg)](https://github.com/hiroki0525/idle-task/actions/workflows/test.yml)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

Improve your website performance by executing JavaScript during a browser's idle periods.

## Install

```shell
npm i idle-task
```

## Usage

The simplest way is to use `setIdleTask` .

```javascript
import { setIdleTask } from 'idle-task';

const sendAnalyticsData = () =>
        console.log("send analytics data during a browser's idle periods.");
setIdleTask(sendAnalyticsData);
```

If you want to get the result of a task, please use `waitForIdleTask` .

```typescript
const checkAccessTokenWhenIdle = (accessToken: string): Promise<any> => {
    const fetchCheckAccessToken = async (): Promise<any> => {
        const response = await fetch(`https://yourdomain/api/check?accessToken=${accessToken}`);
        return response.json();
    };
    const taskId = setIdleTask(fetchCheckAccessToken);
    return waitForIdleTask(taskId);
}

const { isSuccess } = await checkAccessTokenWhenIdle('1234');
```

## API

### `setIdleTask`

```javascript
const sendAnalyticsData = () => console.log("send analytics data");
const options = {
    priority: 'high',
    cache: false
};
const taskId = setIdleTask(sendAnalyticsData, options);
```

`idle-task` has a FIFO(First-In-First-Out) queue.

`setIdleTask` enqueues a task which `idle-task` will dequeue and run when the browser is idle.

`setIdleTask` returns task id which is necessary for `cancelIdleTask` , `isRunIdleTask` and `waitForIdleTask`.

I recommend less than **50 ms** to execute a task because of [RAIL model](https://web.dev/i18n/en/rail/) .
If you want to know how long did it take to finish a task, please use [debug mode](#debug-boolean) .

`setIdleTask` can also be set options as below.

#### priority?: 'low' | 'high'

You can run a task preferentially using `priority: 'high'` (default is `false`) option.
`setIdleTask` adds it to the head of the queue.

#### cache?: boolean

This option is to improve performance.

**`idle-task` caches the results of tasks by default** .

I recommend to set `false` if you don't need the result of idle task.

`waitForIdleTask` will return `undefined` when `cache` is `false` .

```typescript
import {waitForIdleTask} from "./index";

const sendAnalyticsData = (): void => {
    console.log("send analytics data")
};
// Recommend: sendAnalyticsData result is not needed
setIdleTask(sendAnalyticsData, {cache: false});

const generateRandomNumber = () => Math.floor(Math.random() * 100);
const taskId = setIdleTask(generateRandomNumber, {cache: false});
// result is undefined
const result = await waitForIdleTask(taskId);
```

### `waitForIdleTask`

```javascript
const generateRandomNumber = () => Math.floor( Math.random() * 100 );
const taskId = setIdleTask(generateRandomNumber);
const randomNumber = await waitForIdleTask(taskId, {
    cache: false
});
```

You can get the result of the task by using `waitForIdleTask` .

`waitForIdleTask` can also be set options as below.

#### cache?: boolean

**`idle-task` caches the results of tasks by default** .

```javascript
const generateRandomNumber = () => Math.floor( Math.random() * 100 );
const taskId = setIdleTask(generateRandomNumber);
const firstRandomNumber = await waitForIdleTask(taskId);
// this result from cache
const secondRandomNumber = await waitForIdleTask(taskId);
// same objects
console.log(Object.is(firstRandomNumber, secondRandomNumber));
// => true
```

If you get the result of a task **only once**, please set `{ cache: false }` .
This will improve memory in JavaScript.

```javascript
const generateRandomNumber = () => Math.floor( Math.random() * 100 );
const taskId = setIdleTask(generateRandomNumber);
// delete cache
const firstRandomNumber = await waitForIdleTask(taskId, { cache: false });
// this is undefined
const secondRandomNumber = await waitForIdleTask(taskId);
// not same objects
console.log(Object.is(firstRandomNumber, secondRandomNumber));
// => false
```

#### timeout?: number

`waitForIdleTask` maybe wait for the task eternally because it will be finished when the browser is idle.
`timeout` option can prevent it.

```javascript
const generateRandomNumber = () => Math.floor( Math.random() * 100 );
const taskId = setIdleTask(generateRandomNumber);
try {
    const firstRandomNumber = await waitForIdleTask(taskId, { timeout: 1000 });
} catch (e) {
    if (e instanceof WaitForIdleTaskTimeoutError) {
        console.error('this is timeout error')
    }
}
```

In this case, `waitForIdleTask` will throw `WaitForIdleTaskTimeoutError` if the task can't be finished within 1000 ms.

### `getResultFromIdleTask`

```javascript
const generateRandomNumber = () => Math.floor( Math.random() * 100 );
const randomNumber = await getResultFromIdleTask(generateRandomNumber, {
    priority: 'high',
    timeout: 3000,
});

// same
const taskId = setIdleTask(generateRandomNumber, { priority: 'high' });
const randomNumber = await waitForIdleTask(taskId, { timeout: 3000, cache: false });
```

You can get the result by using `getResultFromIdleTask` if you don't need the task id.

`getResultFromIdleTask` can also be set options which is `SetIdleTaskOptions.priority` and  `WaitForIdleTaskOptions.timeout` .

### `cancelIdleTask`

```javascript
const taskId = setIdleTask(() => console.log("task will be canceled."));
cancelIdleTask(taskId);
```

You can stop to run a task by using `cancelIdleTask` if it is not executed.

### `cancelAllIdleTasks`

```javascript
setIdleTask(() => console.log("task 1 will be canceled."));
setIdleTask(() => console.log("task 2 will be canceled."));
setIdleTask(() => console.log("task 3 will be canceled."));
cancelAllIdleTasks();
```

You can stop to run all tasks by using `cancelAllIdleTasks` if they are not executed.

### `isRunIdleTask`

```javascript
const taskId = setIdleTask(() => console.log("task"));
const isRun = isRunIdleTask(taskId);
if (isRun) {
  console.log("the task was completed");
}
```

You can know whether the task is executed or not by using `isRunIdleTask` .

### `configureIdleTask`

```javascript
configureIdleTask({
  interval: 1000 // ms
});
```

`configureIdleTask` configures `idle-task` .
You can set properties as below.

#### interval?: number

`idle-task` checks tasks which was registered by `setIdleTask` during a browser's idle periods, so **they will not always be executed** . 

Please set `interval` if you want to guarantee to run tasks as much as possible.

Even if the browser is not idle, `idle-task` checks tasks every 1000 ms when `interval` is `1000` and **will execute tasks without negative impact on performance**.

#### debug?: boolean

If `debug` is `true`, you can know how long did it take to finish the task via the web console.

I recommend less than **50 ms** to execute a task because of [RAIL model](https://web.dev/i18n/en/rail/) .

The default is `process.env.NODE_ENV === 'development'` .

## License

Released under the MIT license.
